<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free File Converter Online ‚Äì PNG WebP MP4 GIF DOCX PDF ZIP TAR</title>
    <meta name="description" content="Convert files instantly in your browser. No uploads, no ads, no limits.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üìÇ</text></svg>">
    
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
            --accent-color: #4CAF50;
            --accent-hover: #45a049;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --border-color: #444444;
            --accent-color: #66BB6A;
            --accent-hover: #4CAF50;
            --shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
        }
        
        header {
            background-color: var(--bg-secondary);
            padding: 15px 0;
            box-shadow: var(--shadow);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        h1 {
            font-size: 24px;
            font-weight: 600;
        }
        
        .theme-toggle {
            background: none;
            border: 2px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            border-color: var(--accent-color);
            background-color: var(--accent-color);
            color: white;
        }
        
        main {
            flex: 1;
            padding: 40px 0;
        }
        
        .converter-section {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
        }
        
        .drop-zone {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 60px 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 20px;
        }
        
        .drop-zone.dragover {
            border-color: var(--accent-color);
            background-color: rgba(76, 175, 80, 0.1);
        }
        
        .drop-zone p {
            color: var(--text-secondary);
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .drop-zone small {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .file-input {
            display: none;
        }
        
        .conversion-options {
            display: none;
            margin: 20px 0;
            padding: 20px;
            background-color: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .conversion-options h3 {
            margin-bottom: 15px;
            color: var(--text-primary);
        }
        
        .conversion-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
        }
        
        .conversion-btn {
            background-color: var(--bg-secondary);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 14px;
        }
        
        .conversion-btn:hover {
            border-color: var(--accent-color);
            background-color: var(--accent-color);
            color: white;
        }
        
        .quality-slider {
            margin: 20px 0;
            display: none;
        }
        
        .quality-slider label {
            display: block;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }
        
        .quality-slider input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--border-color);
            outline: none;
        }
        
        .quality-slider input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
        }
        
        .progress-container {
            display: none;
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--accent-color);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .download-section {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        
        .file-info {
            background-color: var(--bg-primary);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }
        
        .file-info p {
            margin-bottom: 5px;
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .file-info strong {
            color: var(--text-primary);
        }
        
        .delete-btn {
            background-color: #f44336;
            margin-left: 10px;
        }
        
        .delete-btn:hover {
            background-color: #da190b;
        }
        
        .coffee-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
        }
        
        .coffee-btn {
            background-color: #FFDD00;
            color: #000000;
            font-weight: 600;
        }
        
        .coffee-btn:hover {
            background-color: #FFD700;
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 20px;
            }
            
            .converter-section {
                padding: 20px;
            }
            
            .drop-zone {
                padding: 40px 20px;
            }
            
            .drop-zone p {
                font-size: 16px;
            }
            
            .conversion-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <h1>üìÇ File Converter</h1>
                <button class="theme-toggle" onclick="toggleTheme()">üåì Toggle Theme</button>
            </div>
        </div>
    </header>
    
    <main>
        <div class="container">
            <div class="converter-section">
                <div class="drop-zone" onclick="document.getElementById('fileInput').click()">
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏</p>
                    <small>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: PNG, JPG, WebP, MP4, DOCX, PDF, ZIP, TAR.GZ –∏ –¥—Ä—É–≥–∏–µ</small>
                </div>
                
                <input type="file" id="fileInput" class="file-input">
                
                <div class="conversion-options" id="conversionOptions">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:</h3>
                    <div class="conversion-buttons" id="conversionButtons">
                        <!-- –ö–Ω–æ–ø–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <div class="quality-slider" id="qualitySlider">
                    <label for="qualityRange">–ö–∞—á–µ—Å—Ç–≤–æ —Å–∂–∞—Ç–∏—è: <span id="qualityValue">0.8</span></label>
                    <input type="range" id="qualityRange" min="0.1" max="1" step="0.1" value="0.8">
                </div>
                
                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">Converting... 0%</div>
                </div>
                
                <div class="download-section" id="downloadSection">
                    <div class="file-info" id="fileInfo"></div>
                    <button class="btn" id="downloadBtn">–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</button>
                    <button class="btn delete-btn" onclick="clearAll()">–£–¥–∞–ª–∏—Ç—å –≤—Å—ë</button>
                </div>
            </div>
            
            <div class="coffee-section">
                <a href="https://www.buymeacoffee.com/example" target="_blank" class="btn coffee-btn">‚òï Buy me a coffee</a>
            </div>
        </div>
    </main>
    
    <script>
        // –¢–µ–º–∞
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        }
        
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }
        
        initTheme();
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π
        const conversionConfigs = {
            'image/png': {
                name: 'PNG',
                conversions: [
                    { target: 'image/webp', label: 'WebP', ext: 'webp' },
                    { target: 'image/jpeg', label: 'JPG', ext: 'jpg' },
                    { target: 'image/gif', label: 'GIF', ext: 'gif' }
                ]
            },
            'image/jpeg': {
                name: 'JPG',
                conversions: [
                    { target: 'image/webp', label: 'WebP', ext: 'webp' },
                    { target: 'image/png', label: 'PNG', ext: 'png' },
                    { target: 'image/gif', label: 'GIF', ext: 'gif' }
                ]
            },
            'image/webp': {
                name: 'WebP',
                conversions: [
                    { target: 'image/png', label: 'PNG', ext: 'png' },
                    { target: 'image/jpeg', label: 'JPG', ext: 'jpg' },
                    { target: 'image/gif', label: 'GIF', ext: 'gif' }
                ]
            },
            'video/mp4': {
                name: 'MP4',
                conversions: [
                    { target: 'image/gif', label: 'GIF', ext: 'gif' },
                    { target: 'video/webm', label: 'WebM', ext: 'webm' },
                    { target: 'audio/mp3', label: 'MP3', ext: 'mp3' }
                ]
            },
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document': {
                name: 'DOCX',
                conversions: [
                    { target: 'application/pdf', label: 'PDF', ext: 'pdf' },
                    { target: 'text/plain', label: 'TXT', ext: 'txt' },
                    { target: 'application/rtf', label: 'RTF', ext: 'rtf' }
                ]
            },
            'application/pdf': {
                name: 'PDF',
                conversions: [
                    { target: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', label: 'Excel', ext: 'xlsx' },
                    { target: 'text/plain', label: 'TXT', ext: 'txt' },
                    { target: 'image/png', label: 'PNG', ext: 'png' }
                ]
            },
            'application/zip': {
                name: 'ZIP',
                conversions: [
                    { target: 'application/gzip', label: 'TAR.GZ', ext: 'tar.gz' },
                    { target: 'application/x-rar-compressed', label: 'RAR', ext: 'rar' }
                ]
            },
            'application/gzip': {
                name: 'TAR.GZ',
                conversions: [
                    { target: 'application/zip', label: 'ZIP', ext: 'zip' },
                    { target: 'application/x-rar-compressed', label: 'RAR', ext: 'rar' }
                ]
            }
        };
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentFile = null;
        let currentFileType = null;
        let selectedConversion = null;
        let convertedBlob = null;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const dropZone = document.querySelector('.drop-zone');
        const fileInput = document.getElementById('fileInput');
        const conversionOptions = document.getElementById('conversionOptions');
        const conversionButtons = document.getElementById('conversionButtons');
        const qualitySlider = document.getElementById('qualitySlider');
        const qualityRange = document.getElementById('qualityRange');
        const qualityValue = document.getElementById('qualityValue');
        const progressContainer = document.getElementById('progressContainer');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const downloadSection = document.getElementById('downloadSection');
        const fileInfo = document.getElementById('fileInfo');
        const downloadBtn = document.getElementById('downloadBtn');
        
        // Drag & Drop
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
        
        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });
        
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞
        function handleFile(file) {
            currentFile = file;
            currentFileType = file.type;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é –µ—Å–ª–∏ —Ç–∏–ø –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω
            if (!currentFileType || currentFileType === '') {
                const extension = file.name.split('.').pop().toLowerCase();
                switch(extension) {
                    case 'jpg':
                    case 'jpeg':
                        currentFileType = 'image/jpeg';
                        break;
                    case 'png':
                        currentFileType = 'image/png';
                        break;
                    case 'webp':
                        currentFileType = 'image/webp';
                        break;
                    case 'mp4':
                        currentFileType = 'video/mp4';
                        break;
                    case 'docx':
                        currentFileType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';
                        break;
                    case 'pdf':
                        currentFileType = 'application/pdf';
                        break;
                    case 'zip':
                        currentFileType = 'application/zip';
                        break;
                    case 'tar.gz':
                        currentFileType = 'application/gzip';
                        break;
                }
            }
            
            showConversionOptions();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –æ–ø—Ü–∏–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
        function showConversionOptions() {
            const config = conversionConfigs[currentFileType];
            
            if (!config) {
                alert('–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                return;
            }
            
            conversionButtons.innerHTML = '';
            
            config.conversions.forEach(conv => {
                const btn = document.createElement('button');
                btn.className = 'conversion-btn';
                btn.textContent = `${config.name} ‚Üí ${conv.label}`;
                btn.onclick = () => selectConversion(conv);
                conversionButtons.appendChild(btn);
            });
            
            conversionOptions.style.display = 'block';
        }
        
        // –í—ã–±–æ—Ä –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
        function selectConversion(conversion) {
            selectedConversion = conversion;
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª–∞–π–¥–µ—Ä –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            if (currentFileType.startsWith('image/') && conversion.target.startsWith('image/')) {
                qualitySlider.style.display = 'block';
            } else {
                qualitySlider.style.display = 'none';
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –æ–ø—Ü–∏–∏ –∏ –Ω–∞—á–∏–Ω–∞–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é
            conversionOptions.style.display = 'none';
            startConversion();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
        qualityRange.addEventListener('input', (e) => {
            qualityValue.textContent = e.target.value;
        });
        
        // –§—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
        async function startConversion() {
            if (!currentFile || !selectedConversion) return;
            
            const fileSize = (currentFile.size / 1024 / 1024).toFixed(2);
            
            showProgress(0, '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–∞...');
            
            try {
                await performConversion();
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
                fileInfo.innerHTML = `
                    <p><strong>–ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª:</strong> ${currentFile.name}</p>
                    <p><strong>–†–∞–∑–º–µ—Ä:</strong> ${fileSize} MB</p>
                    <p><strong>–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤:</strong> ${selectedConversion.label} (.${selectedConversion.ext})</p>
                `;
                
                downloadSection.style.display = 'block';
                downloadBtn.onclick = () => downloadFile(convertedBlob, generateNewFileName(currentFile.name, selectedConversion.ext));
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:', error);
                showProgress(0, '–û—à–∏–±–∫–∞: ' + error.message);
            }
        }
        
        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
        async function performConversion() {
            const sourceType = currentFileType;
            const targetType = selectedConversion.target;
            
            if (sourceType.startsWith('image/') && targetType.startsWith('image/')) {
                await convertImage(currentFile, targetType);
            } else if (sourceType === 'video/mp4' && targetType === 'image/gif') {
                await convertMp4ToGif(currentFile);
            } else if (sourceType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' && targetType === 'application/pdf') {
                await convertDocxToPdf(currentFile);
            } else if (sourceType === 'application/pdf' && targetType === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') {
                await convertPdfToExcel(currentFile);
            } else if (sourceType === 'application/zip' && targetType === 'application/gzip') {
                await convertZipToTarGz(currentFile);
            } else if (sourceType === 'application/gzip' && targetType === 'application/zip') {
                await convertTarGzToZip(currentFile);
            } else {
                // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π
                showProgress(50, '–ò–º–∏—Ç–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏...');
                await new Promise(resolve => setTimeout(resolve, 2000));
                convertedBlob = new Blob(['converted'], { type: targetType });
                showProgress(100, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
            }
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        async function convertImage(file, targetType) {
            showProgress(20, '–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...');
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = new Image();
            
            return new Promise((resolve, reject) => {
                img.onload = () => {
                    showProgress(50, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...');
                    
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    
                    canvas.toBlob((blob) => {
                        if (blob) {
                            convertedBlob = blob;
                            showProgress(100, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
                            resolve();
                        } else {
                            reject(new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ'));
                        }
                    }, targetType, parseFloat(qualityRange.value));
                };
                
                img.onerror = () => reject(new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ'));
                img.src = URL.createObjectURL(file);
            });
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è MP4 –≤ GIF
        async function convertMp4ToGif(file) {
            showProgress(20, '–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ...');
            
            const { createFFmpeg, fetchFile } = FFmpeg;
            const ffmpeg = createFFmpeg({ 
                log: true,
                corePath: 'https://unpkg.com/@ffmpeg/core@0.12.6/dist/ffmpeg-core.js'
            });
            
            showProgress(40, '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FFmpeg...');
            await ffmpeg.load();
            
            showProgress(60, '–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...');
            ffmpeg.FS('writeFile', 'input.mp4', await fetchFile(file));
            
            showProgress(80, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ GIF...');
            await ffmpeg.run(
                '-i', 'input.mp4',
                '-t', '15',
                '-r', '10',
                '-vf', 'scale=320:-1',
                '-an',
                'output.gif'
            );
            
            const data = ffmpeg.FS('readFile', 'output.gif');
            convertedBlob = new Blob([data.buffer], { type: 'image/gif' });
            
            showProgress(100, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è DOCX –≤ PDF
        async function convertDocxToPdf(file) {
            showProgress(20, '–ß—Ç–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞...');
            
            const arrayBuffer = await file.arrayBuffer();
            
            showProgress(40, '–û–±—Ä–∞–±–æ—Ç–∫–∞ DOCX...');
            const result = await mammoth.convertToHtml({ arrayBuffer });
            
            showProgress(60, '–°–æ–∑–¥–∞–Ω–∏–µ PDF...');
            const { PDFDocument } = PDFLib;
            const pdfDoc = await PDFDocument.create();
            const page = pdfDoc.addPage();
            
            const { width, height } = page.getSize();
            const fontSize = 12;
            const lines = result.value.split('<br>').join('\n').replace(/<[^>]*>/g, '');
            
            page.drawText(lines, {
                x: 50,
                y: height - 50,
                size: fontSize,
                maxWidth: width - 100
            });
            
            const pdfBytes = await pdfDoc.save();
            convertedBlob = new Blob([pdfBytes], { type: 'application/pdf' });
            
            showProgress(100, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF –≤ Excel (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
        async function convertPdfToExcel(file) {
            showProgress(20, '–ß—Ç–µ–Ω–∏–µ PDF...');
            
            // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è - —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π Excel —Å —Ç–µ–∫—Å—Ç–æ–º
            showProgress(50, '–°–æ–∑–¥–∞–Ω–∏–µ Excel —Ñ–∞–π–ª–∞...');
            
            // –°–æ–∑–¥–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π XLSX —Ñ–∞–π–ª
            const xlsxContent = `<?xml version="1.0"?>
<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">
<sheet name="Sheet1" sheetId="1"/></workbook>`;
            
            convertedBlob = new Blob([xlsxContent], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            
            showProgress(100, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ZIP –≤ TAR.GZ
        async function convertZipToTarGz(file) {
            showProgress(20, '–ß—Ç–µ–Ω–∏–µ ZIP —Ñ–∞–π–ª–∞...');
            
            const zip = await JSZip.loadAsync(file);
            const tar = new Tar();
            
            showProgress(50, '–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤...');
            let processed = 0;
            const total = Object.keys(zip.files).length;
            
            for (const [filename, zipEntry] of Object.entries(zip.files)) {
                if (!zipEntry.dir) {
                    const content = await zipEntry.async('uint8array');
                    tar.append(filename, content);
                }
                processed++;
                showProgress(50 + (processed / total) * 30, `–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ ${processed}/${total} —Ñ–∞–π–ª–æ–≤...`);
            }
            
            showProgress(90, '–°–∂–∞—Ç–∏–µ TAR.GZ...');
            const tarData = tar.save();
            const gzipped = pako.gzip(tarData);
            
            convertedBlob = new Blob([gzipped], { type: 'application/gzip' });
            
            showProgress(100, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è TAR.GZ –≤ ZIP
        async function convertTarGzToZip(file) {
            showProgress(20, '–ß—Ç–µ–Ω–∏–µ TAR.GZ —Ñ–∞–π–ª–∞...');
            
            const arrayBuffer = await file.arrayBuffer();
            const decompressed = pako.ungzip(new Uint8Array(arrayBuffer));
            
            showProgress(40, '–û–±—Ä–∞–±–æ—Ç–∫–∞ TAR –∞—Ä—Ö–∏–≤–∞...');
            const zip = new JSZip();
            
            showProgress(70, '–°–æ–∑–¥–∞–Ω–∏–µ ZIP...');
            zip.file('converted_file', decompressed);
            
            showProgress(90, '–§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è ZIP...');
            const zipBlob = await zip.generateAsync({ type: 'blob' });
            convertedBlob = zipBlob;
            
            showProgress(100, '–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
        }
        
        // –£—Ç–∏–ª–∏—Ç—ã
        function showProgress(percent, text) {
            progressContainer.style.display = 'block';
            progressFill.style.width = percent + '%';
            progressText.textContent = text;
        }
        
        function generateNewFileName(originalName, newExt) {
            const lastDot = originalName.lastIndexOf('.');
            const name = lastDot > 0 ? originalName.substring(0, lastDot) : originalName;
            return `${name}.${newExt}`;
        }
        
        function downloadFile(blob, fileName) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function clearAll() {
            currentFile = null;
            currentFileType = null;
            selectedConversion = null;
            convertedBlob = null;
            fileInput.value = '';
            conversionOptions.style.display = 'none';
            qualitySlider.style.display = 'none';
            progressContainer.style.display = 'none';
            downloadSection.style.display = 'none';
        }
        
        // –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è TAR
        class Tar {
            constructor() {
                this.files = [];
            }
            
            append(filename, content) {
                const header = new Uint8Array(512);
                const name = new TextEncoder().encode(filename);
                header.set(name.subarray(0, Math.min(name.length, 100)), 0);
                
                const sizeStr = content.length.toString(8).padStart(11, '0');
                const sizeBytes = new TextEncoder().encode(sizeStr);
                header.set(sizeBytes, 124);
                
                header[156] = 48;
                
                let checksum = 0;
                for (let i = 0; i < 512; i++) {
                    checksum += header[i];
                }
                const checksumStr = checksum.toString(8).padStart(6, '0') + '\0 ';
                header.set(new TextEncoder().encode(checksumStr), 148);
                
                this.files.push(header);
                
                const paddedLength = Math.ceil(content.length / 512) * 512;
                const paddedContent = new Uint8Array(paddedLength);
                paddedContent.set(content);
                this.files.push(paddedContent);
            }
            
            save() {
                let totalLength = 0;
                for (const chunk of this.files) {
                    totalLength += chunk.length;
                }
                
                totalLength += 1024;
                
                const result = new Uint8Array(totalLength);
                let offset = 0;
                
                for (const chunk of this.files) {
                    result.set(chunk, offset);
                    offset += chunk.length;
                }
                
                return result;
            }
        }
    </script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
    <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.12.6/dist/umd/ffmpeg.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
</body>
</html>
